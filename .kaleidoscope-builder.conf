# -*- mode: sh -*-
update () {
    for f in lib/Kaleidoscope-LangPack-Hungarian \
                 lib/Kaleidoscope-LED-Wavepool \
                 lib/Kaleidoscope-LEDEffect-DigitalRain \
                 lib/FingerprintUSBHost \
                 hardware/keyboardio; do
        echo "Updating $f"
        (cd $f;
         git checkout -q master;
         git pull -q -ff;
         git submodule --quiet update --init --recursive;
         git submodule --quiet foreach --recursive 'echo "Updating $path..."; git checkout -q master; git pull -q -ff';)
    done
}

setup () {
    echo "Cloning..."
    git clone -q https://github.com/algernon/Kaleidoscope-LangPack-Hungarian lib/Kaleidoscope-LangPack-Hungarian
    git clone -q https://github.com/ToyKeeper/Kaleidoscope-LED-Wavepool.git lib/Kaleidoscope-LED-Wavepool
    git clone -q https://github.com/tremby/Kaleidoscope-LEDEffect-DigitalRain.git lib/Kaleidoscope-LEDEffect-DigitalRain
    git clone -q https://github.com/keyboardio/FingerprintUSBHost lib/FingerprintUSBHost
    git clone -q https://github.com/keyboardio/Kaleidoscope-Bundle-Keyboardio hardware/keyboardio
    update
}

LOCAL_CFLAGS="-DKALEIDOSCOPE_HIDADAPTOR_DISABLE_KEYBOARD_BOOT_PROTOCOL=1 -DKALEIDOSCOPE_ENABLE_V1_PLUGIN_API=0"
EXTRA_BUILDER_ARGS="-libraries lib"
BOARD_HARDWARE_PATH="${BOARD_HARDWARE_PATH:-${SOURCEDIR}/hardware}"
DEFAULT_SKETCH="algernon"
